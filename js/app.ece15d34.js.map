{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/Scene.vue?4f96","webpack:///external \"Vue\"","webpack:///./src/components/Menu.vue?908c","webpack:///./src/App.vue?63c7","webpack:///./src/components/Cell.vue?03ed","webpack:///./src/App.vue","webpack:///./src/components/Scene.vue","webpack:///./src/Model/Block.ts","webpack:///./src/components/Cell.vue","webpack:///./src/components/Cell.vue?11f8","webpack:///./src/components/Cell.vue?23cf","webpack:///./src/components/Scene.vue?87b2","webpack:///./src/components/Scene.vue?53da","webpack:///./src/components/Menu.vue","webpack:///./src/components/Menu.vue?3225","webpack:///./src/components/Menu.vue?0885","webpack:///./src/Model/Game.ts","webpack:///./src/Model/Event.ts","webpack:///./src/App.vue?3acc","webpack:///./src/App.vue?dfb6","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Vue","class","style","game","width","cellSize","widthNum","heightNum","height","paddingSize","matrix","nextBlock","keyRefresh","score","state","keyEvents","keyMobile","rowItem","rowIdx","col","colIdx","size","type","circle","icon","plain","shape","BlockModelList","source","x","y","rotateIdx","this","_key","_shape","_source","_x","_y","_rotateIdx","idx","Math","floor","random","Block","speed","newRotateIdx","newShape","forEach","row","val","undefined","newX","newY","props","Number","render","__scopeId","required","Array","Function","components","Cell","String","downInterval","_state","_height","_width","_cellSize","_paddingSize","_matrix","renderDefaultMatrix","_curBlock","randomRenderBlock","_nextBlock","_speed","_downInterval","_score","flag","clearTimeout","autoDown","options","canNext","renderNewMatrix","down","baseLineLen","every","clearArr","computedScore","newMatrix","JSON","parse","stringify","unshift","fill","defaultMatrix","curBlock","clearLine","some","arr","matrixRow","over","message","refresh","downWithTimeout","setTimeout","canClearLine","nextAround","navigator","vibrate","start","pause","b_move","b_down","Scene","Menu","setup","offsetWidth","document","documentElement","clientWidth","fontSize","eventInstance","e","code","addEventListener","removeEventListener","app","App","component","a","mount"],"mappings":"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","file":"js/app.ece15d34.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Scene.vue?vue&type=style&index=0&id=c245c4b8&lang=less&scoped=true\"","module.exports = Vue;","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Menu.vue?vue&type=style&index=0&id=f116a9c4&lang=less&scoped=true\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=0&id=84ddd440&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Cell.vue?vue&type=style&index=0&id=7af3c193&lang=less&scoped=true\"","<template>\n  <div\n    class=\"container\"\n    :style=\"{ width: `${(game.width + 6) * game.cellSize}rem` }\"\n  >\n    <Scene\n      :widthNum=\"game.width\"\n      :heightNum=\"game.height\"\n      :cellSize=\"game.cellSize\"\n      :paddingSize=\"game.paddingSize\"\n      :matrix=\"game.matrix\"\n      :nextBlock=\"game.nextBlock\"\n      :keyRefresh=\"keyRefresh\"\n      :score=\"game.score\"\n    />\n    <Menu :state=\"game.state\" :keyEvents=\"keyMobile\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, onMounted, onUnmounted, reactive, ref } from \"vue\";\nimport Scene from \"./components/Scene.vue\";\nimport Menu from \"./components/Menu.vue\";\nimport GameClass from \"@/Model/Game\";\nimport EventClass from \"@/Model/Event\";\n\nexport default defineComponent({\n  name: \"App\",\n  components: {\n    Scene,\n    Menu,\n  },\n  setup() {\n    const heightNum = ref(24);\n    const widthNum = ref(12);\n    const offsetWidth = document.documentElement.clientWidth;\n    if (offsetWidth >= 1200) {\n      document.documentElement.style.fontSize = 14 + \"px\";\n      heightNum.value = 20;\n    }\n    // 以 plus 为断点\n    if (offsetWidth <= 500 && offsetWidth >= 340) {\n      document.documentElement.style.fontSize = 10 + \"px\";\n    }\n\n    // 如果真的还有人在用 iphone5 的话\n    if (offsetWidth <= 340) {\n      document.documentElement.style.fontSize = 10 + \"px\";\n      heightNum.value = 16;\n      widthNum.value = 8;\n    }\n\n    const game = reactive<GameClass>(\n      new GameClass(\"over\", widthNum.value, heightNum.value, 2, 2)\n    ) as GameClass;\n\n    const eventInstance = new EventClass();\n\n    const keyEvents = (e: KeyboardEvent) => {\n      eventInstance.keyEvents(e.code, game);\n    };\n    const keyMobile = (type: string) => {\n      eventInstance.keyEvents(type, game);\n    };\n    const keyRefresh = () => {\n      eventInstance.keyEvents(\"KeyR\", game);\n    };\n\n    onMounted(() => {\n      window.addEventListener(\"keydown\", keyEvents);\n    });\n\n    onUnmounted(() => {\n      window.removeEventListener(\"keydown\", keyEvents);\n    });\n\n    return {\n      game,\n      keyEvents,\n      keyMobile,\n      keyRefresh,\n    };\n  },\n});\n</script>\n\n<style>\nhtml,\nbody {\n  font-size: 14px;\n  width: 100%;\n  height: 100%;\n}\n#app {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.container {\n  height: 100%;\n  /* height: 35rem; */\n  display: flex;\n  flex-flow: column nowrap;\n}\n</style>\n","<template>\n  <div\n    class=\"scence-container\"\n    :style=\"{\n      padding: `${paddingSize}px`,\n    }\"\n  >\n    <div class=\"game\">\n      <el-row v-for=\"(rowItem, rowIdx) in matrix\" :key=\"rowIdx\">\n        <Cell\n          v-for=\"(col, colIdx) in rowItem\"\n          :key=\"colIdx\"\n          :size=\"cellSize\"\n          :paddingSize=\"paddingSize\"\n          :value=\"col\"\n        />\n      </el-row>\n    </div>\n    <div class=\"controller\" :style=\"{ width: 5 * cellSize + 'rem' }\">\n      <div class=\"refresh-btn\">\n        <el-button\n          type=\"danger\"\n          circle\n          size=\"small\"\n          icon=\"el-icon-refresh\"\n          plain\n          @click=\"keyRefresh()\"\n        />\n      </div>\n      <div class=\"score\">\n        <span>分数: </span>\n        <span>{{ score }}</span>\n      </div>\n      <div class=\"next_block\">\n        <span>Next</span>\n        <el-row v-for=\"(rowItem, rowIdx) in nextBlock.shape\" :key=\"rowIdx\">\n          <Cell\n            v-for=\"(col, colIdx) in rowItem\"\n            :key=\"colIdx\"\n            :size=\"cellSize - 0.5\"\n            :paddingSize=\"paddingSize\"\n            :value=\"col\"\n          />\n        </el-row>\n      </div>\n      <div class=\"options-info\">\n        <p>操作提示</p>\n        <div>\n          <span>空格：</span>\n          <span>开始/暂停</span>\n        </div>\n        <div>\n          <span>R：</span>\n          <span>刷新</span>\n        </div>\n        <div>\n          <span>↑/W：</span>\n          <span>旋转</span>\n        </div>\n        <div>\n          <span>←/S：</span>\n          <span>左移</span>\n        </div>\n        <div>\n          <span>→/D：</span>\n          <span>右移</span>\n        </div>\n        <div>\n          <span>↓/S：</span>\n          <span>加速</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport Block from \"@/Model/Block\";\nimport { defineComponent } from \"vue\";\nimport Cell from \"./Cell.vue\";\n\nexport default defineComponent({\n  name: \"Scene\",\n  props: {\n    cellSize: {\n      type: Number,\n      required: true,\n    },\n    paddingSize: {\n      type: Number,\n      required: true,\n    },\n    matrix: {\n      type: Array,\n      required: true,\n    },\n    nextBlock: {\n      type: Block,\n      required: true,\n    },\n    score: {\n      type: Number,\n      required: true,\n    },\n    keyRefresh: {\n      type: Function,\n    },\n  },\n  components: {\n    Cell,\n  },\n});\n</script>\n\n<style lang=\"less\" scoped>\n.scence-container {\n  border: 3px solid #67c23a;\n  background-color: #e1f3d8;\n  display: flex;\n  .controller {\n    display: flex;\n    padding: 20px 5px;\n    font-size: 14px;\n    font-weight: bolder;\n    color: #79bbff;\n    flex-direction: column;\n    justify-content: space-between;\n\n    .refresh-btn {\n      height: 10%;\n      display: flex;\n      justify-content: center;\n      align-items: baseline;\n    }\n    .next_block {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      span {\n        padding-bottom: 5px;\n      }\n    }\n    .score {\n      text-align: center;\n    }\n    .options-info {\n      p {\n        font-size: 14px;\n        text-align: center;\n        margin-bottom: 5px;\n      }\n      div {\n        font-size: 12px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        span {\n          text-align: start;\n        }\n      }\n    }\n  }\n}\n</style>\n","/**\n * 16方格块组成的，各类方块\n */\nconst BlockModelList = [\n  {\n    key: \"T\",\n    shape: [\n      [1, 1, 1],\n      [0, 1, 0],\n    ],\n    source: [\n      [0, 0],\n      [1, 0],\n      [-1, 1],\n      [0, -1],\n    ],\n    x: -1,\n    y: 4,\n  },\n  {\n    key: \"L\",\n    shape: [\n      [1, 0, 0],\n      [1, 1, 1],\n    ],\n    source: [[0, 0]],\n    x: -1,\n    y: 4,\n  },\n  {\n    key: \"J\",\n    shape: [\n      [0, 0, 1],\n      [1, 1, 1],\n    ],\n    source: [[0, 0]],\n    x: -1,\n    y: 4,\n  },\n  {\n    key: \"O\",\n    shape: [\n      [1, 1],\n      [1, 1],\n    ],\n    source: [[0, 0]],\n    x: -1,\n    y: 4,\n  },\n  {\n    key: \"I\",\n    shape: [[1, 1, 1, 1]],\n    source: [\n      [-1, 1],\n      [1, -1],\n    ],\n    x: 0,\n    y: 3,\n  },\n  {\n    key: \"Z\",\n    shape: [\n      [1, 1, 0],\n      [0, 1, 1],\n    ],\n    source: [[0, 0]],\n    x: -1,\n    y: 4,\n  },\n];\n\nclass Block {\n  private _key; // 方块的类别\n  private _shape; // 对应形状\n  private _source; // 源点\n  private _x; // 对应在矩阵的x , 也就是列\n  private _y; // 对应在矩阵的y , 也就是行\n  private _rotateIdx; // 旋转到第几次了\n\n  public get key() {\n    return this._key;\n  }\n  public set key(value) {\n    this._key = value;\n  }\n\n  public get shape() {\n    return this._shape;\n  }\n  public set shape(value) {\n    this._shape = value;\n  }\n\n  public get source() {\n    return this._source;\n  }\n  public set source(value) {\n    this._source = value;\n  }\n\n  public get x() {\n    return this._x;\n  }\n  public set x(value) {\n    this._x = value;\n  }\n\n  public get y() {\n    return this._y;\n  }\n  public set y(value) {\n    this._y = value;\n  }\n\n  public get rotateIdx() {\n    return this._rotateIdx;\n  }\n  public set rotateIdx(value) {\n    this._rotateIdx = value;\n  }\n\n  constructor(\n    key: string,\n    shape: number[][],\n    source: number[][],\n    x: number,\n    y: number,\n    rotateIdx = 0\n  ) {\n    this._key = key;\n    this._shape = shape;\n    this._source = source;\n    this._x = x;\n    this._y = y;\n    this._rotateIdx = rotateIdx;\n  }\n\n  public randomRenderBlock(): Block {\n    const idx = Math.floor(Math.random() * BlockModelList.length);\n    const { key, shape, source, x, y } = BlockModelList[idx];\n    return new Block(key, shape, source, x, y);\n  }\n\n  public left(): Block {\n    return new Block(\n      this._key,\n      this._shape,\n      this._source,\n      this._x,\n      this._y - 1,\n      this._rotateIdx\n    );\n  }\n\n  public right(): Block {\n    return new Block(\n      this._key,\n      this._shape,\n      this._source,\n      this._x,\n      this._y + 1,\n      this._rotateIdx\n    );\n  }\n\n  public down(speed = 1): Block {\n    return new Block(\n      this._key,\n      this._shape,\n      this._source,\n      this._x + speed,\n      this._y,\n      this._rotateIdx\n    );\n  }\n\n  public rotate(): Block {\n    const shape = this._shape;\n    const newShape: number[][] = [];\n    shape.forEach((row) =>\n      row.forEach((val, colIdx) => {\n        const idx = row.length - colIdx - 1;\n        // 不满的就补齐\n        if (newShape[idx] === undefined) {\n          newShape[idx] = [];\n        }\n\n        newShape[idx].push(val);\n        // 最后解构赋给行\n        newShape[idx] = [...newShape[idx]];\n      })\n    );\n    // 记录一下旋转的次数\n    let newRotateIdx;\n    // 如果旋转了一轮了, 就回到最初的状态\n    if (this._rotateIdx + 1 >= this._source.length) {\n      newRotateIdx = 0;\n    } else {\n      newRotateIdx = this._rotateIdx + 1;\n    }\n    const newX = this._x + this._source[this._rotateIdx][0];\n    const newY = this._y + this._source[this._rotateIdx][1];\n\n    return new Block(\n      this._key,\n      newShape,\n      this._source,\n      newX,\n      newY,\n      newRotateIdx\n    );\n  }\n}\n\nexport default Block;\n","<template>\n  <div\n    :class=\"value === 0 ? 'block' : 'block-active'\"\n    :style=\"{\n      width: `${size}rem`,\n      height: `${size}rem`,\n      padding: `${paddingSize}px`,\n    }\"\n  >\n    <div\n      :class=\"value === 0 ? 'block-container' : 'block-active-container'\"\n    ></div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    size: Number,\n    paddingSize: Number,\n    value: Number,\n  },\n});\n</script>\n\n<style lang=\"less\" scoped>\n.block {\n  display: inline-block;\n  border: 2px solid #dcdfe6;\n  box-sizing: border-box;\n  margin: \"1px\";\n  &-active {\n    display: inline-block;\n    border: 2px solid #409eff;\n    box-sizing: border-box;\n    &-container {\n      width: 100%;\n      height: 100%;\n      background: #409eff;\n    }\n  }\n  &-container {\n    width: 100%;\n    height: 100%;\n    background: #ebeef5;\n  }\n}\n</style>\n","\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    size: Number,\n    paddingSize: Number,\n    value: Number,\n  },\n});\n","import { render } from \"./Cell.vue?vue&type=template&id=7af3c193&scoped=true\"\nimport script from \"./Cell.vue?vue&type=script&lang=ts\"\nexport * from \"./Cell.vue?vue&type=script&lang=ts\"\n\nimport \"./Cell.vue?vue&type=style&index=0&id=7af3c193&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-7af3c193\"\n\nexport default script","\nimport Block from \"@/Model/Block\";\nimport { defineComponent } from \"vue\";\nimport Cell from \"./Cell.vue\";\n\nexport default defineComponent({\n  name: \"Scene\",\n  props: {\n    cellSize: {\n      type: Number,\n      required: true,\n    },\n    paddingSize: {\n      type: Number,\n      required: true,\n    },\n    matrix: {\n      type: Array,\n      required: true,\n    },\n    nextBlock: {\n      type: Block,\n      required: true,\n    },\n    score: {\n      type: Number,\n      required: true,\n    },\n    keyRefresh: {\n      type: Function,\n    },\n  },\n  components: {\n    Cell,\n  },\n});\n","import { render } from \"./Scene.vue?vue&type=template&id=c245c4b8&scoped=true\"\nimport script from \"./Scene.vue?vue&type=script&lang=ts\"\nexport * from \"./Scene.vue?vue&type=script&lang=ts\"\n\nimport \"./Scene.vue?vue&type=style&index=0&id=c245c4b8&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-c245c4b8\"\n\nexport default script","<template>\n  <div class=\"menu-container\">\n    <div class=\"left\">\n      <el-button\n        size=\"medium\"\n        type=\"primary\"\n        circle\n        plain\n        :icon=\"state === 'start' ? 'el-icon-video-pause' : 'el-icon-video-play'\"\n        style=\"transform: scale(2)\"\n        @click=\"keyEvents('Space')\"\n      />\n    </div>\n    <div class=\"right\">\n      <div class=\"up_btn\">\n        <el-button\n          size=\"medium\"\n          icon=\"el-icon-caret-top\"\n          type=\"primary\"\n          circle\n          @click=\"keyEvents('ArrowUp')\"\n        />\n      </div>\n      <div class=\"left_right_btns\">\n        <el-button\n          size=\"medium\"\n          icon=\"el-icon-caret-left\"\n          type=\"primary\"\n          circle\n          @click=\"keyEvents('ArrowLeft')\"\n        />\n        <el-button\n          size=\"medium\"\n          icon=\"el-icon-caret-right\"\n          type=\"primary\"\n          circle\n          @click=\"keyEvents('ArrowRight')\"\n        />\n      </div>\n      <div class=\"down_btn\">\n        <el-button\n          size=\"medium\"\n          icon=\"el-icon-caret-bottom\"\n          type=\"primary\"\n          circle\n          @click=\"keyEvents('ArrowDown')\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    state: {\n      type: String,\n      required: true,\n    },\n    keyEvents: {\n      type: Function,\n      required: true,\n    },\n  },\n});\n</script>\n<style lang=\"less\" scoped>\n.menu-container {\n  border: 3px solid #67c23a;\n  border-top: none;\n  background: #e1f3d8;\n  display: flex;\n  justify-content: center;\n  flex-grow: 1;\n  .left {\n    width: 50%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .right {\n    padding-top: 2px;\n    width: 50%;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n\n    .up_btn,\n    .left_right_btns,\n    .down_btn {\n      width: 100%;\n      display: flex;\n      justify-content: space-evenly;\n    }\n  }\n}\n</style>\n","\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    state: {\n      type: String,\n      required: true,\n    },\n    keyEvents: {\n      type: Function,\n      required: true,\n    },\n  },\n});\n","import { render } from \"./Menu.vue?vue&type=template&id=f116a9c4&scoped=true\"\nimport script from \"./Menu.vue?vue&type=script&lang=ts\"\nexport * from \"./Menu.vue?vue&type=script&lang=ts\"\n\nimport \"./Menu.vue?vue&type=style&index=0&id=f116a9c4&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-f116a9c4\"\n\nexport default script","import Block from \"@/Model/Block\";\nimport { ElMessage } from \"element-plus\";\n\nclass Game {\n  private _state: \"start\" | \"pause\" | \"over\"; // 游戏状态\n  private _width: number; // 宽度格子数\n  private _height: number; // 高度上的格子数\n  private _cellSize: number; // 单元格的大小\n  private _paddingSize: number; // padding 尺寸\n  private _matrix: number[][]; // 矩阵数据\n  private _curBlock: Block; // 当前在移动的方块\n  private _nextBlock: Block; // 下一次的方块\n  private _downInterval?: NodeJS.Timeout; // 自动下落的计时器的 time\n  private _speed: number; // 下落速度，也就是 setTimeout 的延时\n  private _score: number; //分数统计\n\n  public get state(): \"start\" | \"pause\" | \"over\" {\n    return this._state;\n  }\n  public set state(value: \"start\" | \"pause\" | \"over\") {\n    this._state = value;\n  }\n  public get width(): number {\n    return this._width;\n  }\n  public set width(value: number) {\n    this._width = value;\n  }\n\n  public get height(): number {\n    return this._height;\n  }\n  public set height(value: number) {\n    this._height = value;\n  }\n\n  public get cellSize(): number {\n    return this._cellSize;\n  }\n  public set cellSize(value: number) {\n    this._cellSize = value;\n  }\n\n  public get paddingSize(): number {\n    return this._paddingSize;\n  }\n  public set paddingSize(value: number) {\n    this._paddingSize = value;\n  }\n\n  public get matrix(): number[][] {\n    return this._matrix;\n  }\n  public set matrix(value: number[][]) {\n    this._matrix = value;\n  }\n\n  public get curBlock(): Block {\n    return this._curBlock;\n  }\n  public set curBlock(value: Block) {\n    this._curBlock = value;\n  }\n  public get nextBlock(): Block {\n    return this._nextBlock;\n  }\n  public set nextBlock(value: Block) {\n    this._nextBlock = value;\n  }\n  public get speed(): number {\n    return this._speed;\n  }\n  public set speed(value: number) {\n    this._speed = value;\n  }\n  public get score(): number {\n    return this._score;\n  }\n  public set score(value: number) {\n    this._score = value;\n  }\n\n  constructor(\n    state: \"over\" | \"start\" | \"pause\",\n    width = 10,\n    height = 20,\n    cellSize = 20,\n    paddingSize = 2,\n    speed = 500,\n    score = 0,\n    downInterval = undefined\n  ) {\n    this._state = state;\n    this._height = height;\n    this._width = width;\n    this._cellSize = cellSize;\n    this._paddingSize = paddingSize;\n    this._matrix = this.renderDefaultMatrix();\n    this._curBlock = Block.prototype.randomRenderBlock();\n    this._nextBlock = Block.prototype.randomRenderBlock();\n    this._speed = speed;\n    this._downInterval = downInterval;\n    this._score = score;\n  }\n\n  // 游戏结束判断\n  public over(matrix: number[][]): boolean {\n    //如果第一行的有下落方块就证明触顶了\n    let flag = false;\n    matrix[0].forEach((val) => {\n      if (val === 2) {\n        flag = true;\n        this._state = \"over\";\n        clearTimeout(this._downInterval as NodeJS.Timeout);\n      }\n    });\n    return flag;\n  }\n\n  // 游戏开始\n  public start() {\n    // 这里是因为，constructor 直接时调用两次 random\n    // Math.random 时间戳种子伪随机，然后每次初始化都会出两个一个样的\n    if (this._state === \"over\") {\n      this._curBlock = this._nextBlock;\n      this._nextBlock = Block.prototype.randomRenderBlock();\n    }\n    this._state = \"start\";\n    this.autoDown();\n  }\n\n  // 游戏暂停\n  public pause() {\n    this._state = \"pause\";\n    clearTimeout(this._downInterval as NodeJS.Timeout);\n  }\n\n  // 刷新游戏\n  public refresh() {\n    clearTimeout(this._downInterval as NodeJS.Timeout);\n    this._state = \"over\";\n    this._score = 0;\n    this._matrix = this.renderDefaultMatrix();\n    this._curBlock = Block.prototype.randomRenderBlock();\n    this._nextBlock = Block.prototype.randomRenderBlock();\n    this._speed = 500;\n    this._downInterval = undefined;\n    return;\n  }\n\n  // 控制方块移动\n  public b_move(options: \"left\" | \"right\" | \"rotate\") {\n    const nextBlock = this._curBlock[options]();\n    if (this.canNext(nextBlock)) {\n      this._curBlock = nextBlock;\n      this._matrix = this.renderNewMatrix(this._curBlock, this._matrix, 1);\n    }\n  }\n\n  // 手动加速下坠\n  public b_down() {\n    clearTimeout(this._downInterval as NodeJS.Timeout);\n    const nextBlock = this._curBlock.down();\n    if (this.canNext(nextBlock)) {\n      this._curBlock = nextBlock;\n      this._matrix = this.renderNewMatrix(this._curBlock, this._matrix, 1);\n    }\n    this.autoDown();\n  }\n\n  // 下一位置是否合法\n  public canNext(nextBlock: Block): boolean {\n    const { x, y, shape } = nextBlock;\n    // 方块的宽度\n    const baseLineLen = shape[0].length;\n    return shape.every((row, rowIdx) =>\n      row.every((val, colIdx) => {\n        // 碰到左边\n        if (y < 0) {\n          return false;\n        }\n\n        // 碰到右边\n        if (y + baseLineLen > this._width) {\n          return false;\n        }\n\n        // 碰到底部\n        if (x + rowIdx >= this._height) {\n          return false;\n        }\n\n        // 从顶部出来是可以的\n        if (x + rowIdx < 0) {\n          return true;\n        }\n\n        // 方块模型碰到已经固定在矩阵中的部分\n        if (val) {\n          if (this._matrix[rowIdx + x][colIdx + y] === 2) {\n            return false;\n          }\n          return true;\n        }\n        return true;\n      })\n    );\n  }\n\n  // 判断是否可以清除\n  public clearLine(matrix: number[][]): number[][] | void {\n    // 存储需要清除的行，因为可能同时很多行一起清除\n    const clearArr: number[] = [];\n    matrix.forEach((row, rowIdx) => {\n      if (row.every((val) => val === 2)) {\n        clearArr.push(rowIdx);\n      }\n    });\n\n    if (clearArr.length > 0) {\n      // 如果可以清除，那就同时也更新分数\n      // 加一的操作就是, 如果同时清了很多行，分数也多加一点\n      this.computedScore(clearArr.length * (this._width + 1) - 1);\n      const newMatrix = JSON.parse(JSON.stringify(matrix));\n      clearArr.forEach((rowIdx) => {\n        newMatrix.splice(rowIdx, 1);\n        //再追加一个空白行进去\n        newMatrix.unshift(new Array(this._width).fill(0));\n      });\n      return newMatrix;\n    }\n    return;\n  }\n\n  // 渲染默认矩阵, 也就是空白矩阵\n  private renderDefaultMatrix(): number[][] {\n    const defaultMatrix: number[][] = [[]];\n    for (let i = 0; i < this._height; i++) {\n      defaultMatrix[i] = new Array(this._width).fill(0);\n    }\n    return defaultMatrix;\n  }\n\n  // 渲染最新的矩阵\n  // 触底的方块在矩阵中值设为 2 和移动中的方块进行区分\n  private renderNewMatrix(curBlock: Block, matrix: number[][], data: number) {\n    const { shape, x, y } = curBlock;\n    const newMatrix: number[][] = JSON.parse(JSON.stringify(matrix));\n    const clearArr = this.clearLine(matrix);\n    let idx = 0;\n    newMatrix.some((row) => {\n      row.some((val, colIdx, arr) => {\n        if (val === 1) {\n          arr[colIdx] = 0;\n          idx++;\n        }\n        // 如果已经清除了 4 个就跳出\n        if (idx >= 4) {\n          return true;\n        }\n      });\n    });\n    shape.forEach((row, rowIdx) =>\n      row.forEach((val, colIdx) => {\n        if (val && x + rowIdx >= 0) {\n          const matrixRow = newMatrix[x + rowIdx];\n          if (!clearArr) {\n            matrixRow[y + colIdx] = data;\n            newMatrix[x + rowIdx] = matrixRow;\n          }\n        }\n      })\n    );\n    return newMatrix;\n  }\n\n  // 方块自动下落\n  private autoDown() {\n    if (this.over(this._matrix)) {\n      clearTimeout(this._downInterval as NodeJS.Timeout);\n      ElMessage({\n        type: \"error\",\n        message: \"Game Over! 重新开始吧！\",\n      });\n      this.refresh();\n      return;\n    }\n    const downWithTimeout = () => {\n      const curBlock = this._curBlock;\n      const nextBlock = curBlock.down();\n      // 如果可以下落就将当前块置为下一状态\n      if (this.canNext(nextBlock)) {\n        this._curBlock = nextBlock;\n        this._matrix = this.renderNewMatrix(this._curBlock, this._matrix, 1);\n        this._downInterval = setTimeout(downWithTimeout, this._speed);\n      } else {\n        // 否则则触底\n        // 触底的时候检查能否消除行\n        const newMatrix: number[][] = this.renderNewMatrix(\n          this._curBlock,\n          this._matrix,\n          2\n        );\n        const canClearLine = this.clearLine(newMatrix);\n        this.nextAround(canClearLine ? canClearLine : newMatrix);\n      }\n    };\n    clearTimeout(this._downInterval as NodeJS.Timeout);\n    this._downInterval = setTimeout(downWithTimeout, this._speed);\n  }\n\n  // 一个方块结束, 触发下一个\n  private nextAround(matrix: number[][]) {\n    clearTimeout(this._downInterval as NodeJS.Timeout);\n    this._matrix = matrix;\n    setTimeout(() => {\n      this._curBlock = this._nextBlock;\n      this._nextBlock = Block.prototype.randomRenderBlock();\n      this.autoDown();\n    }, 100);\n  }\n\n  // 更新分数\n  private computedScore(n: number) {\n    this._score = this._score + n;\n  }\n}\n\nexport default Game;\n","import Game from \"./Game\";\n\n// export type keyType =\n//   | \"Space\"\n//   | \"ArrowUp\"\n//   | \"ArrowDown\"\n//   | \"ArrowLeft\"\n//   | \"ArrowRight\"\n//   | \"KeyR\"\nclass Event {\n  public keyEvents(type: string, game: Game) {\n    // 阻止非游戏状态下的操作\n    if (type !== \"Space\" && game.state !== \"start\" && type !== \"KeyR\") {\n      return;\n    }\n    if (navigator.vibrate) {\n      navigator.vibrate(50);\n    }\n    switch (type) {\n      case \"Space\":\n        if (game.state === \"over\" || game.state === \"pause\") {\n          game.start();\n        } else if (game.state === \"start\") {\n          game.pause();\n        }\n        return;\n\n      case \"ArrowLeft\":\n      case \"KeyA\":\n        game.b_move(\"left\");\n        return;\n\n      case \"ArrowRight\":\n      case \"KeyD\":\n        game.b_move(\"right\");\n        return;\n\n      case \"ArrowUp\":\n      case \"KeyW\":\n        game.b_move(\"rotate\");\n        return;\n\n      case \"ArrowDown\":\n      case \"KeyS\":\n        game.b_down();\n        return;\n\n      case \"KeyR\":\n        game.refresh();\n        return;\n    }\n  }\n}\n\nexport default Event;\n","\nimport { defineComponent, onMounted, onUnmounted, reactive, ref } from \"vue\";\nimport Scene from \"./components/Scene.vue\";\nimport Menu from \"./components/Menu.vue\";\nimport GameClass from \"@/Model/Game\";\nimport EventClass from \"@/Model/Event\";\n\nexport default defineComponent({\n  name: \"App\",\n  components: {\n    Scene,\n    Menu,\n  },\n  setup() {\n    const heightNum = ref(24);\n    const widthNum = ref(12);\n    const offsetWidth = document.documentElement.clientWidth;\n    if (offsetWidth >= 1200) {\n      document.documentElement.style.fontSize = 14 + \"px\";\n      heightNum.value = 20;\n    }\n    // 以 plus 为断点\n    if (offsetWidth <= 500 && offsetWidth >= 340) {\n      document.documentElement.style.fontSize = 10 + \"px\";\n    }\n\n    // 如果真的还有人在用 iphone5 的话\n    if (offsetWidth <= 340) {\n      document.documentElement.style.fontSize = 10 + \"px\";\n      heightNum.value = 16;\n      widthNum.value = 8;\n    }\n\n    const game = reactive<GameClass>(\n      new GameClass(\"over\", widthNum.value, heightNum.value, 2, 2)\n    ) as GameClass;\n\n    const eventInstance = new EventClass();\n\n    const keyEvents = (e: KeyboardEvent) => {\n      eventInstance.keyEvents(e.code, game);\n    };\n    const keyMobile = (type: string) => {\n      eventInstance.keyEvents(type, game);\n    };\n    const keyRefresh = () => {\n      eventInstance.keyEvents(\"KeyR\", game);\n    };\n\n    onMounted(() => {\n      window.addEventListener(\"keydown\", keyEvents);\n    });\n\n    onUnmounted(() => {\n      window.removeEventListener(\"keydown\", keyEvents);\n    });\n\n    return {\n      game,\n      keyEvents,\n      keyMobile,\n      keyRefresh,\n    };\n  },\n});\n","import { render } from \"./App.vue?vue&type=template&id=84ddd440\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=84ddd440&lang=css\"\nscript.render = render\n\nexport default script","import { createApp } from \"vue\";\nimport { ElButton, ElMessage, ElRow } from \"element-plus\";\nimport \"element-plus/lib/theme-chalk/index.css\";\nimport App from \"./App.vue\";\n\nconst app = createApp(App);\napp.component(ElButton.name, ElButton);\napp.component(ElRow.name, ElRow);\napp.component(ElMessage.name, ElMessage);\napp.mount(\"#app\");\n"],"sourceRoot":""}